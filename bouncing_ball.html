<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouncing div</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            width: 100vw;
            height: 100vh;
            position: relative;
            background-color: #000;
            align-self: center;
        }
        
        #div {
            width: 1rem;
            height: 1rem;
            border: none;
            border-radius: 50%;
            background-color: #fff;
            position: absolute;
            transform: translate(-50%, -50%);
        }
    </style>
</head>

<body>
    <div id="div" style="top: 50%; left: 50%;"></div>
    <canvas id="myCanvas"></canvas>
    <script>
        const div = document.querySelector('#div');
        const rect = div.getBoundingClientRect();
        let t = rect.top + 8;
        let l = rect.left + 8;
        let tRule = 'positive';
        let lRule = 'positive';
        const changeColor = () => {
            const r = Math.floor(Math.random() * 256);
            const g = Math.floor(Math.random() * 256);
            const b = Math.floor(Math.random() * 256);
            div.style.backgroundColor = `rgb(${r},${g},${b})`;
        }
        changeColor();
        setInterval(() => {
            tRule == 'positive' ? t++ : t--;
            if (t < 8) {
                tRule = 'positive';
                changeColor();
            } else if (t > document.body.offsetHeight - 8) {
                tRule = 'negative';
                changeColor();
            }
            lRule == "positive" ? l++ : l--;
            if (l < 8) {
                lRule = 'positive';
                changeColor();
            } else if (l > document.body.offsetWidth - 8) {
                lRule = 'negative';
                changeColor();
            }
            div.style.top = t + 'px';
            div.style.left = l + 'px';
        }, 1);
        // canvas
        const canvas = document.getElementById('myCanvas');
        canvas.width = document.body.offsetWidth;
        canvas.height = document.body.offsetHeight;
        const ctx = canvas.getContext('2d');
        let moveCircle = null
        const animate = () => {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            xRule == 'pos' ? startX++ : startX--;
            startX > canvas.width - rad ? xRule = 'neg' : startX < rad ? xRule = 'pos' : xRule = xRule
            yRule == 'pos' ? startY++ : startY--;
            startY > canvas.height - rad ? yRule = 'neg' : startY < rad ? yRule = 'pos' : yRule = yRule
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(startX, startY, rad, 0 * Math.PI, 2 * Math.PI);
            ctx.fill();
        }
        const rad = 20
        let startX = canvas.width / 2;
        let startY = canvas.height / 2;
        let xRule = 'pos';
        let yRule = 'pos';
        moveCircle = setInterval(animate, 1);
    </script>
</body>

</html>